{"id": "trace-0t04oj", "title": "CLI: Add --with-references flag to show command", "description": "**Problem:** No easy way to see 'what references this issue' or 'what would be unblocked if I close this'.\n\n**Proposed enhancement:**\n```bash\ntrc show <issue-id> --with-references\n```\n\n**Output would include:**\n```\n[Current show output]\n\nReferences:\n  Children (3):\n    - trace-xxx: Some child issue [open]\n    - trace-yyy: Another child [closed]\n  \n  Blocked by this (2):\n    - trace-zzz: Implementation waiting on this [blocked]\n  \n  Related issues (1):\n    - trace-aaa: Similar investigation in other module\n```\n\n**Use cases:**\n- Understanding impact before closing an issue\n- Finding implementation work that references investigation findings\n- Discovering orphaned issues\n\n**Alternative:** Could make this default behavior of `trc show`, not requiring a flag.", "status": "closed", "priority": 2, "created_at": "2025-11-20T21:59:27.750584Z", "updated_at": "2025-11-21T00:56:56.372406Z", "closed_at": null, "dependencies": [{"depends_on_id": "trace-1gbj2x", "type": "parent"}]}
{"id": "trace-11efq1", "title": "Update documentation for new list default behavior", "description": "Update all documentation to reflect that trc list now defaults to showing backlog (open, in_progress, blocked) and supports multiple --status flags. Need to update CLI design docs, quickstart guide, AI agent guide, and any other relevant docs.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:23.236754Z", "updated_at": "2025-11-18T14:30:31.681839Z", "closed_at": "2025-11-18T14:30:31.681839Z", "dependencies": []}
{"id": "trace-11mmza", "title": "Test batch 1", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-30T23:46:39.368711Z", "updated_at": "2025-11-30T23:46:52.638088Z", "closed_at": "2025-11-30T23:46:52.638088Z", "dependencies": []}
{"id": "trace-11ovo8", "title": "Test without description again", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:31:12.833549Z", "updated_at": "2025-11-17T21:34:00.138603Z", "closed_at": "2025-11-17T21:34:00.138603Z", "dependencies": []}
{"id": "trace-11v9uy", "title": "Update all code references to use new project_id system", "description": "Update all functions that use project_id: create_issue(), sync_project(), CLI commands, etc. Ensure they work with both remote URLs and local paths. Update project lookups to handle name collisions (pick first match for now - YAGNI).", "status": "closed", "priority": 0, "created_at": "2025-11-30T16:16:45.483240Z", "updated_at": "2025-11-30T16:40:59.897404Z", "closed_at": "2025-11-30T16:40:59.897404Z", "dependencies": [{"depends_on_id": "trace-t2yxk3", "type": "parent"}]}
{"id": "trace-12b0cz", "title": "Update trc guide command output", "description": "Update the guide() function in trc_main.py (lines 1863-1936) to reflect new list behavior in the AI agent integration guide text.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:42.862278Z", "updated_at": "2025-11-18T14:29:28.482419Z", "closed_at": "2025-11-18T14:29:28.482419Z", "dependencies": [{"depends_on_id": "trace-11efq1", "type": "parent"}]}
{"id": "trace-133mzu", "title": "Update cli-design.md for new list behavior", "description": "Update docs/cli-design.md to document: (1) trc list now defaults to backlog [open, in_progress, blocked], (2) --status flag can be specified multiple times, (3) --status any shows all statuses including closed. Update command reference and examples.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:42.502325Z", "updated_at": "2025-11-18T14:28:28.440485Z", "closed_at": "2025-11-18T14:28:28.440485Z", "dependencies": [{"depends_on_id": "trace-11efq1", "type": "parent"}]}
{"id": "trace-13l3ra", "title": "CLI: Improve error message when closing issue with open children", "description": "**Original proposal:** Add guidance to error message when trying to close issue with open children.\n\n**Current error message:**\n```\nError: Cannot close issue with open children:\n  - test-dual-parent-1d3gjt: Child 1 [open]\n```\n\n**Location:** trc_main.py:1452-1456\n\n## Analysis\n\n### Current Message Provides Sufficient Information\nThe error message contains the minimal information needed to make a good decision:\n1. \u2705 Clear problem: \"Cannot close issue with open children\"\n2. \u2705 Lists the blocking children with IDs, titles, and status\n3. \u2705 User can see exactly what's blocking the close operation\n\n### Proposed Addition (from original trace)\n```\nIf these children are deliverables (not sub-tasks), consider:\n  1. 'trc reparent <child-id> <new-parent>' to move them\n  2. 'trc reparent <child-id> none' to make them top-level\n  3. Close children if they're documentation artifacts\n\nRun 'trc tree <issue-id>' to visualize the hierarchy.\n```\n\n### Problems with Proposed Addition\n\n1. **Makes assumptions about user's mental model**\n   - \"If these children are deliverables (not sub-tasks)\" - assumes this distinction\n   - May not apply to all use cases\n   \n2. **Adds noise without clear value**\n   - Users who understand their structure know what to do\n   - LLMs may not process the guidance effectively anyway\n   \n3. **Duplicates documentation**\n   - Investigation pattern (trace-1y3m2h) addresses root cause\n   - Documentation should teach patterns, not error messages\n   \n4. **LLM-first tool consideration**\n   - LLMs don't benefit from verbose error guidance like humans do\n   - They need clear, concise error messages\n   - Pattern understanding comes from documentation/prompts, not error text\n\n## YAGNI Assessment\n\nThis is premature optimization:\n- Current error message works fine\n- No evidence that users are confused by it\n- Better to focus on higher-value changes to the framework\n- Should evaluate how LLMs actually use the tool before adding verbosity\n\n**Better approach:**\n- Keep error messages minimal and clear\n- Put usage patterns in documentation (trace-1y3m2h)\n- Monitor actual usage to see if this becomes a real problem\n\n## Decision\n\n**Close this issue.** Current error message is sufficient.\n\nThe real solution to confusion is:\n1. Documentation improvements (trace-1y3m2h - investigation pattern)\n2. Understanding how LLMs actually use trace in practice\n3. Letting usage patterns emerge before optimizing\n\nIf future usage reveals users are frequently confused by this error, we can revisit. But currently, this is solving a problem that doesn't exist.\n\n**Related:**\n- trace-1y3m2h: Investigation pattern documentation (addresses root cause)\n- trace-1gbj2x: Parent issue for UX improvements", "status": "closed", "priority": 2, "created_at": "2025-11-20T21:59:09.896045Z", "updated_at": "2025-11-21T14:12:57.128289Z", "closed_at": "2025-11-21T14:12:57.128289Z", "dependencies": [{"depends_on_id": "trace-1gbj2x", "type": "parent"}]}
{"id": "trace-14czms", "title": "Update AI agent guide with mandatory description principle", "description": "Update docs/ai-agent-guide.md to emphasize ALWAYS providing descriptions. Add section on why this matters for cross-session work. Show the empty string opt-out. Include examples of good vs bad descriptions. Part of making --description mandatory (trace-nbiip2).", "status": "closed", "priority": 2, "created_at": "2025-11-17T20:13:12.888726Z", "updated_at": "2025-11-17T21:24:18.946619Z", "closed_at": "2025-11-17T21:24:18.946619Z", "dependencies": [{"depends_on_id": "trace-nbiip2", "type": "parent"}]}
{"id": "trace-151sj8", "title": "Update detect_project() to use git remote URL as project_id", "description": "Modify detect_project() to return git remote URL (e.g., github.com/user/repo) as the project_id instead of absolute path. Fall back to absolute path for repos without remotes. Extract project name from URL or directory name.", "status": "closed", "priority": 0, "created_at": "2025-11-30T16:16:45.016230Z", "updated_at": "2025-11-30T16:27:51.822765Z", "closed_at": "2025-11-30T16:27:51.822765Z", "dependencies": [{"depends_on_id": "trace-t2yxk3", "type": "parent"}]}
{"id": "trace-15iqup", "title": "Add batch close operation for multiple issues", "description": "Support closing multiple issues in one command: trc close ID1 ID2 ID3. Currently must close one at a time which is tedious for AI agents completing multiple tasks.", "status": "closed", "priority": 1, "created_at": "2025-11-30T15:31:07.600401Z", "updated_at": "2025-11-30T23:46:58.928572Z", "closed_at": "2025-11-30T23:46:58.928572Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-15lm9i", "title": "Fix test isolation - tests modify real ~/.trace/trace.db", "description": "CRITICAL BUG: Running 'uv run pytest' modifies the real ~/.trace/trace.db database instead of using isolated test environments. This caused loss of all tracked issues after running tests. Need to: (1) Override get_trace_home() in tests to use temp directories, (2) Ensure pytest fixtures create isolated DBs per test, (3) Add TRACE_TEST_MODE environment variable as safeguard. Tests should NEVER touch real user data. This is a data loss bug.", "status": "closed", "priority": 0, "created_at": "2025-11-17T20:27:06.225838Z", "updated_at": "2025-11-17T20:29:59.224434Z", "closed_at": "2025-11-17T20:29:59.224434Z", "dependencies": []}
{"id": "trace-167sry", "title": "Replace --all flag with --project any in trc_main.py", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:53:02.464576Z", "updated_at": "2025-11-17T19:55:39.155645Z", "closed_at": "2025-11-17T19:55:39.155645Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}]}
{"id": "trace-16so9a", "title": "Fix transaction safety for DB and JSONL writes", "description": "BUG: Partial writes to global DB even when JSONL fails. Should rollback DB changes or complete both atomically. Need proper transaction handling to prevent inconsistent state.\n\nREPRODUCTION STEPS:\n1. User does NOT run 'trc init' first\n2. JSONL file (.trace/issues.jsonl) does not exist\n3. User runs 'trc create' command\n4. Issue gets created in central DB successfully\n5. JSONL export fails (because .trace directory doesn't exist)\n6. Result: DB has the issue, JSONL doesn't - data inconsistency\n\nROOT CAUSE: Commands don't check if project is initialized before modifying DB. DB writes succeed, JSONL writes fail, no rollback.\n\nFIX APPROACH:\n- Either: Check for .trace/issues.jsonl existence before DB operations\n- Or: Wrap DB + JSONL in transaction, rollback DB if JSONL fails\n- Or: Create .trace directory automatically before JSONL export\n- Best: Validate initialization upfront and fail fast with helpful error", "status": "closed", "priority": 0, "created_at": "2025-11-30T15:31:07.903057Z", "updated_at": "2025-11-30T23:36:44.903584Z", "closed_at": "2025-11-30T23:36:44.903584Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-170t20", "title": "Status milestone progression: new \u2192 ready \u2192 in_progress \u2192 closed", "description": "Introduce a status progression that distinguishes between traces that need review vs traces that are ready to work.\n\n## Current State\n\n### Existing Statuses\n- **open**: Default for new traces\n- **in_progress**: Actively being worked\n- **blocked**: Has unresolved blocking dependencies\n- **closed**: Complete\n\n### Existing 'trc ready' Command\nShows work that is **unblocked** (no blocking dependencies preventing start). This is a computed query, not a status - it finds open/in_progress items where all blocking deps are resolved.\n\n### Current Flow\n```\nopen \u2192 in_progress \u2192 closed\n         \u2193\n      blocked (computed based on dependencies)\n```\n\n---\n\n## Problem Statement\n\nThere's no distinction between:\n1. **Traces just captured** - raw ideas, may need investigation, scoping, or validation\n2. **Traces confirmed ready to work** - reviewed, scoped, validated, actually belong in backlog\n\nCurrently both are 'open'. This means:\n- The backlog mixes unvetted ideas with confirmed work\n- No clear signal that a trace has been reviewed and approved\n- AI agents (or humans) can't distinguish 'just an idea' from 'do this next'\n\n---\n\n## Proposed Status Flow\n```\nnew \u2192 ready \u2192 in_progress \u2192 closed\n                  \u2193\n               blocked\n```\n\nWhere:\n- **new**: Just created, needs review/investigation\n- **ready**: Reviewed, scoped, confirmed as valid work\n- **in_progress**: Actively being worked\n- **blocked**: Has unresolved blocking dependencies  \n- **closed**: Complete\n\n---\n\n## Design Options Identified\n\n### Option A: Add Status Values\nChange statuses to: new, ready, in_progress, blocked, closed\n\n**Implications:**\n- 'blocked' becomes a status rather than computed state\n- Conflict: `trc ready` command name vs 'ready' status\n- Migration: existing 'open' traces become... what? 'new'? 'ready'?\n- Schema change to status enum\n\n### Option B: Separate 'Vetted' Flag\nKeep current statuses, add boolean `vetted` or `reviewed` field\n\n**Implications:**\n- Two dimensions: status (open/in_progress/closed) AND vetted (true/false)\n- `trc ready` stays unambiguous (shows unblocked)\n- `trc list --vetted` or `trc list --reviewed` for filtered view\n- Less disruptive to existing model\n- But: is this just status with extra steps?\n\n### Option C: Rename Commands to Clarify Concepts\n- Rename `trc ready` \u2192 `trc unblocked` (shows items with no blocking deps)\n- Add 'ready' as a status between 'open' and 'in_progress'\n\n**Implications:**\n- Clean separation: status is workflow position, blocking is dependency state\n- Breaking change to CLI command names\n- Clearer mental model long-term\n- Migration path: 'open' \u2192 'new', add 'ready' status\n\n---\n\n## Questions Requiring Discussion\n\n### Semantic Questions\n1. What exactly does 'reviewed' or 'ready' mean? Who decides? What criteria?\n2. Is this a human workflow concern or does it matter for AI agents?\n3. Should 'ready' be permission to start, or just 'has been looked at'?\n\n### Interaction Questions\n4. How does parent 'ready' status affect children? Inherited? Independent?\n5. Can you go backwards? ready \u2192 new if scope changes?\n6. What should `trc list` default to showing? new? ready? both?\n\n### Technical Questions\n7. If 'blocked' becomes a status, how does it interact with computed blocking deps?\n8. What's the migration path for existing traces?\n9. Does JSONL schema need versioning?\n\n### Philosophical Questions\n10. Is this over-engineering for the 'fluid structure' philosophy?\n11. Does adding process gates contradict 'make reorganization trivial'?\n12. For AI agent workflows specifically - does this add value or friction?\n\n---\n\n## Future State Considerations\n\nIf implemented, this could enable:\n- Inbox/triage workflows: `trc list --status new` as review queue\n- Backlog confidence: 'ready' items are committed work\n- Metrics: time from new \u2192 ready (decision latency), ready \u2192 closed (execution time)\n- Different views for different contexts (planning vs execution)\n\nBut could also:\n- Add ceremony to what should be lightweight\n- Create status management overhead\n- Conflict with 'structure should be fluid' philosophy", "status": "open", "priority": 2, "created_at": "2025-11-25T16:34:23.581016Z", "updated_at": "2025-11-25T16:54:10.368433Z", "closed_at": null, "dependencies": []}
{"id": "trace-17tmdu", "title": "Update CLAUDE.md default behaviors section", "description": "Update CLAUDE.md 'Default Behaviors' section to document new trc list behavior. Update the bullet point about trc list to clarify backlog default and multi-status support.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:43.109955Z", "updated_at": "2025-11-18T14:29:49.719341Z", "closed_at": "2025-11-18T14:29:49.719341Z", "dependencies": [{"depends_on_id": "trace-11efq1", "type": "parent"}]}
{"id": "trace-17xlxu", "title": "Add --project flag to 'trc create' command", "description": "The 'trc create' command doesn't have a --project flag to specify which project an issue should be created in. Currently users must either cd to the project directory or create the issue and then use 'trc move'. Expected usage: 'trc create \"title\" --description \"...\" --project /path/to/project' or 'trc create \"title\" --description \"...\" --project project-name'. This would streamline cross-project issue creation. Discovered when trying to create trace documentation issue from knowledge-organization-framework project.", "status": "closed", "priority": 2, "created_at": "2025-11-18T02:10:40.218011Z", "updated_at": "2025-11-18T02:48:34.383288Z", "closed_at": "2025-11-18T02:48:34.383288Z", "dependencies": []}
{"id": "trace-186ji4", "title": "Update trc guide to emphasize mandatory --description", "description": "Update the cli_guide() output to reflect that --description is now mandatory. Show the empty string opt-out pattern. Emphasize why this matters for AI agents (context preservation across sessions). Part of making --description mandatory (trace-nbiip2).", "status": "closed", "priority": 2, "created_at": "2025-11-17T20:13:12.461189Z", "updated_at": "2025-11-17T21:22:19.434442Z", "closed_at": "2025-11-17T21:22:19.434442Z", "dependencies": [{"depends_on_id": "trace-nbiip2", "type": "parent"}]}
{"id": "trace-197nsf", "title": "Add priority text values (high/critical/low)", "description": "YAGNI - Not implementing. Numeric priorities (0-4) are sufficient for now.", "status": "closed", "priority": 3, "created_at": "2025-11-30T15:31:08.213192Z", "updated_at": "2025-12-01T01:41:30.149828Z", "closed_at": "2025-12-01T01:41:30.149828Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-1ak6bv", "title": "Refactor flags to use --project any and --status any for consistency", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:52:46.978133Z", "updated_at": "2025-11-17T23:11:10.316046Z", "closed_at": "2025-11-17T23:11:10.316046Z", "dependencies": []}
{"id": "trace-1bb5hb", "title": "CLI: Warn when creating dual-parent relationships", "description": "**Original Problem:** `trc add-dependency X Y --type parent` silently creates dual parents if X already has a parent, which was thought to cause confusion.\n\n## Investigation Findings\n\nTested actual behavior of dual parents in trace. Results:\n\n### Tree Display: Works Perfectly \u2713\n```\nGrandparent\n\u251c\u2500 Parent A\n\u2502  \u2514\u2500 Child C [appears here]\n\u2514\u2500 Parent B\n   \u2514\u2500 Child C [also appears here - same child, shown in both branches]\n```\n\nThe tree display correctly shows Child C under both parents when viewing from grandparent level. Viewing `trc tree parent-a` shows Child C, and `trc tree parent-b` also shows Child C. This is the expected and correct behavior.\n\n### Closing Logic: Consistent \u2713\n- Cannot close Parent A while Child C is open (blocks correctly)\n- Cannot close Parent B while Child C is open (blocks correctly)\n- Once Child C is closed, can close Parent A independently\n- Or can close Parent B independently\n- Or can close both\n- Child C shows as closed under both parent branches\n\n### Conclusion: Dual Parents Are Not A Problem\n\nDual parents work exactly as expected:\n- Tree visualization is clear (child appears under both parents)\n- Closing logic is consistent (child blocks both parents)\n- Relationships are maintained correctly\n- No ambiguity or confusion in the implementation\n\n## Real Root Cause: Documentation Gap\n\nThe confusion about dual parents came from **investigation pattern misunderstanding**, not from dual parents being technically problematic.\n\nWhen users got confused about \"investigation findings vs implementation work\", they accidentally created dual parents because the pattern wasn't documented. The solution is **better documentation** (trace-1y3m2h), not warnings.\n\n## Why Warning Is Wrong Approach\n\n**Problem with warning for LLM-first tool:**\n1. LLM sees: \"Warning: dual parent. Continue? [y/N]\"\n2. LLM either:\n   - Always says yes (defeating purpose)\n   - Gets confused and asks user\n   - Makes arbitrary choice\n3. Warning doesn't help LLM make better decision\n\n**Better approach:** Document the patterns clearly so LLM creates correct structure from the start.\n\n## YAGNI Assessment\n\nAdding dual-parent warnings is a YAGNI (You Aren't Gonna Need It) change:\n- Dual parents work correctly in the implementation\n- The confusion comes from usage patterns, not the feature\n- Investigation pattern documentation (trace-1y3m2h) addresses root cause\n- May discover other patterns in the future that also use dual parents\n- Better to let real usage patterns emerge before adding constraints\n\n## Decision\n\n**Close this issue.** Dual parents are not a problem. Focus on documentation improvements instead.\n\nIf future usage reveals specific problems with dual parents, we can revisit. But currently, this is solving a problem that doesn't exist at the technical level.\n\n**Related:**\n- trace-1y3m2h: Investigation pattern documentation (addresses root cause)\n- trace-1gbj2x: Parent issue for UX improvements", "status": "closed", "priority": 1, "created_at": "2025-11-20T21:59:18.621057Z", "updated_at": "2025-11-21T14:05:10.642073Z", "closed_at": "2025-11-21T14:05:10.642073Z", "dependencies": [{"depends_on_id": "trace-1gbj2x", "type": "parent"}]}
{"id": "trace-1bbnww", "title": "Implement auto-merge logic for identifier changes", "description": "Detect when project_id changes for same directory (e.g., local path \u2192 remote URL when user adds remote, or remote URL changes). Automatically merge old project into new project, updating all issue references.", "status": "closed", "priority": 0, "created_at": "2025-11-30T16:16:45.364949Z", "updated_at": "2025-11-30T19:37:05.857403Z", "closed_at": "2025-11-30T19:37:05.857403Z", "dependencies": [{"depends_on_id": "trace-t2yxk3", "type": "parent"}]}
{"id": "trace-1bsib5", "title": "Implement --status filter in list_issues() and cli_ready()", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:54:55.903268Z", "updated_at": "2025-11-17T23:11:05.951962Z", "closed_at": "2025-11-17T23:11:05.951962Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}, {"depends_on_id": "trace-1jpyzc", "type": "blocks"}]}
{"id": "trace-1c9z04", "title": "CLI: Add remove-dependency command", "description": "**Problem:** No way to remove dependencies once added. Users must manually edit .trace/issues.jsonl (not recommended) or directly modify the database.\n\n## How Dependencies Work\n\nAll relationships use a single `dependencies` table with three types:\n\n1. **`type = 'parent'`** - Parent-child hierarchy\n   - `issue_id` is the child\n   - `depends_on_id` is the parent\n   - Used by `trc tree` to build hierarchy\n\n2. **`type = 'blocks'`** - Blocking dependency\n   - `issue_id` is the blocked issue (can't start until blocker done)\n   - `depends_on_id` is the blocker (must be completed first)\n   - Used by `trc ready` to filter out blocked work\n\n3. **`type = 'related'`** - Informational link\n   - No blocking behavior\n   - Just indicates two issues are related\n\n**Schema:**\n```sql\nCREATE TABLE dependencies (\n    issue_id TEXT NOT NULL,\n    depends_on_id TEXT NOT NULL,\n    type TEXT NOT NULL,\n    created_at TEXT NOT NULL,\n    PRIMARY KEY (issue_id, depends_on_id)\n);\n```\n\n## Valid Use Cases for Removing Dependencies\n\n1. **Incorrect blocks relationship**: \"Issue B doesn't actually depend on Issue A\"\n2. **Changed requirements**: \"We decided to do this in parallel, remove the blocker\"\n3. **Wrong related link**: \"These aren't actually related, I linked the wrong issue\"\n4. **Removing dual parents**: While dual parents work fine technically, user may want to clean up\n5. **Reparenting scenarios**: Remove parent without immediately adding a new one\n\n## Implementation Plan\n\n### Proposed Command Signature\n\n```bash\ntrc remove-dependency <issue-id> <dependency-id> [--type parent|blocks|related]\n```\n\n**Arguments:**\n- `issue_id`: The issue that has the dependency\n- `dependency_id`: The issue that is depended upon\n- `--type`: Optional, specifies which type to remove (if omitted, removes all types)\n\n### Examples\n\n```bash\n# Remove blocking dependency (Issue B no longer blocked by Issue A)\ntrc remove-dependency issue-b issue-a --type blocks\n\n# Remove parent relationship (Issue C no longer child of Issue A)\ntrc remove-dependency issue-c issue-a --type parent\n\n# Remove all relationships between two issues\ntrc remove-dependency issue-x issue-y\n```\n\n### Implementation Details\n\n**Code location:** Add CLI command in trc_main.py (around line 1750, near add-dependency)\n\n**Internal function exists:** `remove_dependency()` already exists at line 703-719:\n```python\ndef remove_dependency(\n    db: sqlite3.Connection,\n    issue_id: str,\n    depends_on_id: str,\n) -> None:\n    \"\"\"Remove a dependency between two issues.\"\"\"\n    db.execute(\n        \"DELETE FROM dependencies WHERE issue_id = ? AND depends_on_id = ?\",\n        (issue_id, depends_on_id),\n    )\n    db.commit()\n```\n\n**Note:** Current internal function removes ALL types of dependencies between two issues. Need to either:\n1. Add `type` parameter to internal function to support selective removal\n2. Make CLI remove all types if no `--type` specified\n\n### Proposed CLI Implementation\n\n```python\n@app.command(name=\"remove-dependency\")\ndef remove_dependency_cmd(\n    issue_id: Annotated[str, typer.Argument(help=\"Issue ID that has the dependency\")],\n    depends_on_id: Annotated[str, typer.Argument(help=\"Issue that is depended upon\")],\n    dep_type: Annotated[Optional[str], typer.Option(\"--type\", help=\"Dependency type to remove (parent, blocks, related). If omitted, removes all types.\")] = None,\n):\n    \"\"\"Remove a dependency between two existing issues.\"\"\"\n    \n    lock_path = get_lock_path()\n    with file_lock(lock_path):\n        db = get_db()\n        \n        # Resolve issue IDs to get project paths\n        issue = get_issue_by_id(db, issue_id)\n        dependency = get_issue_by_id(db, depends_on_id)\n        \n        if not issue:\n            print(f\"Error: Issue '{issue_id}' not found\")\n            db.close()\n            raise typer.Exit(code=1)\n            \n        if not dependency:\n            print(f\"Error: Issue '{depends_on_id}' not found\")\n            db.close()\n            raise typer.Exit(code=1)\n        \n        # Check if dependency exists\n        if dep_type:\n            cursor = db.execute(\n                \"SELECT 1 FROM dependencies WHERE issue_id = ? AND depends_on_id = ? AND type = ?\",\n                (issue_id, depends_on_id, dep_type)\n            )\n            if not cursor.fetchone():\n                print(f\"Error: No {dep_type} dependency from {issue_id} to {depends_on_id}\")\n                db.close()\n                raise typer.Exit(code=1)\n                \n            # Remove specific type\n            db.execute(\n                \"DELETE FROM dependencies WHERE issue_id = ? AND depends_on_id = ? AND type = ?\",\n                (issue_id, depends_on_id, dep_type)\n            )\n            print(f\"Removed {dep_type} dependency: {issue_id} \u2192 {depends_on_id}\")\n        else:\n            cursor = db.execute(\n                \"SELECT type FROM dependencies WHERE issue_id = ? AND depends_on_id = ?\",\n                (issue_id, depends_on_id)\n            )\n            types = [row[0] for row in cursor.fetchall()]\n            \n            if not types:\n                print(f\"Error: No dependencies from {issue_id} to {depends_on_id}\")\n                db.close()\n                raise typer.Exit(code=1)\n            \n            # Remove all types\n            remove_dependency(db, issue_id, depends_on_id)\n            print(f\"Removed {', '.join(types)} dependencies: {issue_id} \u2192 {depends_on_id}\")\n        \n        # Export to JSONL for both projects\n        for project_path in {issue[\"project_id\"], dependency[\"project_id\"]}:\n            trace_dir = Path(project_path) / \".trace\"\n            jsonl_path = trace_dir / \"issues.jsonl\"\n            export_to_jsonl(db, project_path, str(jsonl_path))\n            set_last_sync_time(db, project_path, time.time())\n        \n        db.close()\n```\n\n### Testing Checklist\n\n- [ ] Remove parent dependency (verify `trc tree` updates correctly)\n- [ ] Remove blocks dependency (verify `trc ready` updates correctly)\n- [ ] Remove related dependency (verify `trc show` updates correctly)\n- [ ] Remove all dependencies between two issues (no --type specified)\n- [ ] Error handling: dependency doesn't exist\n- [ ] Error handling: issue IDs don't exist\n- [ ] Cross-project dependencies (ensure both JSONL files updated)\n- [ ] Verify JSONL export after removal\n\n## Impact\n\n- **Complexity:** Low - internal function exists, just need CLI wrapper\n- **Value:** High - enables fixing mistakes without manual file editing\n- **Risk:** Low - removal is safer than adding\n- **Testing:** Straightforward\n\n## Priority Justification\n\n**Priority 1** because:\n- No workaround except manual file editing\n- Blocking users from fixing their own mistakes\n- Implementation is straightforward (function exists)\n- Frequently needed operation (people make linking mistakes)", "status": "open", "priority": 1, "created_at": "2025-11-20T21:59:03.575486Z", "updated_at": "2025-11-21T14:09:31.818221Z", "closed_at": null, "dependencies": [{"depends_on_id": "trace-1gbj2x", "type": "parent"}]}
{"id": "trace-1d5uth", "title": "Fix trc list to show backlog by default (exclude closed)", "description": "Currently trc list with no --status flag shows ALL issues including closed. Should default to showing backlog: open + in_progress + blocked (everything except closed).\n\nImplementation approach:\n1. Update list_issues() to support multiple statuses (accept Optional[str | list[str]] and use SQL IN clause)\n2. Update list CLI command to accept multiple --status flags (e.g., trc list --status open --status in_progress)\n3. Default behavior when no --status provided: show ['open', 'in_progress', 'blocked']\n4. Keep --status any to mean 'show all statuses'\n5. Write tests for multi-status behavior\n6. Verify all existing tests still pass\n\nThis aligns with mental model: trc list = backlog, trc ready = actionable work, trc list --status closed = done.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:13:29.742968Z", "updated_at": "2025-11-18T14:23:56.206121Z", "closed_at": "2025-11-18T14:23:56.206121Z", "dependencies": []}
{"id": "trace-1dn75j", "title": "CLI: Make --project flag accept both names and paths", "description": "## Root Cause Analysis (CONFIRMED)\n\n**The bug is real.** The `--project` flag only accepts project **names** (like `flink-cdc`), not paths (like `~/Repos/flink-cdc`).\n\n### Code Analysis\n\nIn `trc_main.py:1230-1245`, the project lookup only queries by name:\n\n```python\nif project_flag:\n    # Look up in registry\n    cursor = db.execute(\n        \"SELECT path, name FROM projects WHERE name = ?\",\n        (project_flag,)\n    )\n```\n\n**What happened:**\n1. `--project ~/Repos/flink-cdc` \u2192 searches WHERE name=\"~/Repos/flink-cdc\" \u2192 not found\n2. `--project /Users/don.schartman/Repos/flink-cdc` \u2192 searches WHERE name=\"/Users/...\" \u2192 not found  \n3. `--project flink-cdc` \u2192 searches WHERE name=\"flink-cdc\" \u2192 found! \u2713\n\n### Why This Is Unintuitive\n\n- Project IDs internally use absolute paths (`project_id` = full path)\n- Error message doesn't explain you need to use name, not path\n- Users naturally try paths since that's how they think about locations\n- No documentation mentions this name-only requirement\n\n### Proposed Fix\n\nMake `--project` accept **either** name OR path:\n\n```python\nif project_flag:\n    # Look up in registry by name OR path\n    db = get_db()\n    \n    # Expand path if it looks like one\n    expanded_path = None\n    if \"/\" in project_flag or project_flag.startswith(\"~\"):\n        expanded_path = str(Path(project_flag).expanduser().resolve())\n    \n    # Try both name and path lookups\n    cursor = db.execute(\n        \"SELECT path, name FROM projects WHERE name = ? OR path = ?\",\n        (project_flag, expanded_path or project_flag)\n    )\n    row = cursor.fetchone()\n    \n    if row is None:\n        print(f\"Error: Project '{project_flag}' not found in registry\")\n        print(\"Hint: Run 'trc list --project any' to see available projects\")\n        db.close()\n        raise typer.Exit(code=1)\n```\n\nThis would make all forms work:\n- `--project flink-cdc` \u2713 (lookup by name)\n- `--project ~/Repos/flink-cdc` \u2713 (lookup by expanded path)\n- `--project /Users/don.schartman/Repos/flink-cdc` \u2713 (lookup by path)\n\n### Impact\n\n- Low implementation complexity\n- High UX improvement\n- Makes behavior consistent with how users think about projects\n- Backward compatible (existing name-based usage still works)\n\n### Locations to Fix\n\nThis pattern appears in multiple commands that accept `--project`:\n- `cli_create` (trc_main.py:1226)\n- `cli_list` (trc_main.py:1305) - uses \"any\" special case, may need update\n- `cli_ready` (trc_main.py:1472) - uses \"any\" special case, may need update\n\nShould extract into helper function: `resolve_project(project_flag: str) -> dict`", "status": "open", "priority": 2, "created_at": "2025-11-20T17:46:58.650688Z", "updated_at": "2025-11-21T13:44:32.369983Z", "closed_at": null, "dependencies": []}
{"id": "trace-1eaowh", "title": "Test without description", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:30:40.206131Z", "updated_at": "2025-11-17T21:34:00.116055Z", "closed_at": "2025-11-17T21:34:00.116055Z", "dependencies": []}
{"id": "trace-1f0fvk", "title": "Write test for list --project filtering", "description": "Write test that verifies 'trc list --project <name>' filters to that specific project when run from a different project directory. Test should fail initially, then pass after implementation.", "status": "closed", "priority": 2, "created_at": "2025-11-30T19:54:14.111810Z", "updated_at": "2025-11-30T19:55:04.841628Z", "closed_at": "2025-11-30T19:55:04.841628Z", "dependencies": [{"depends_on_id": "trace-1toxy1", "type": "parent"}]}
{"id": "trace-1f62s8", "title": "Update ai-agent-guide.md for new list behavior", "description": "Update docs/ai-agent-guide.md to document new list defaults and multi-status support. Ensure AI agents understand: trc list = backlog, trc list --status any = everything, multiple --status flags supported.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:42.740467Z", "updated_at": "2025-11-18T14:30:31.569158Z", "closed_at": "2025-11-18T14:30:31.569158Z", "dependencies": [{"depends_on_id": "trace-11efq1", "type": "parent"}]}
{"id": "trace-1gbj2x", "title": "UX: Improve guidance for investigation pattern and parent-child relationships", "description": "Feedback from AI agent usage in change-capture project investigating Schema Registry removal.\n\n**Problem:** Agent got confused about when to create children vs siblings during investigation, leading to dual-parent relationships and inability to close investigation.\n\n**Root cause:** Lack of clear guidance on distinguishing 'investigation outputs' (documentation that closes with investigation) vs 'implementation work' (stays open after investigation).\n\n**Proposed improvements split into child issues:**\n1. Documentation improvements for investigation pattern\n2. CLI UX improvements for parent-child operations\n3. Validation tooling to catch structural issues\n\nSee children for detailed suggestions.", "status": "open", "priority": 1, "created_at": "2025-11-20T21:58:47.936980Z", "updated_at": "2025-11-20T21:58:47.936980Z", "closed_at": null, "dependencies": []}
{"id": "trace-1h6l1d", "title": "Fix ready command --project flag filtering", "description": "Apply same three-way logic fix to ready command as was done for list command", "status": "closed", "priority": 2, "created_at": "2025-11-30T19:54:14.352008Z", "updated_at": "2025-11-30T19:55:40.270280Z", "closed_at": "2025-11-30T19:55:40.270280Z", "dependencies": [{"depends_on_id": "trace-1toxy1", "type": "parent"}]}
{"id": "trace-1hs8ox", "title": "Update CLI parsing in main() for new flags", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:54:56.330278Z", "updated_at": "2025-11-17T23:11:06.001950Z", "closed_at": "2025-11-17T23:11:06.001950Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}, {"depends_on_id": "trace-7fpjn5", "type": "blocks"}]}
{"id": "trace-1j0gin", "title": "Add or document dependency removal command", "description": "Nice-to-have: Need trc remove-dependency command (may exist but not documented in guide). Currently no clear way to remove dependencies between issues.", "status": "closed", "priority": 3, "created_at": "2025-11-30T15:31:08.694986Z", "updated_at": "2025-11-30T15:47:15.656985Z", "closed_at": "2025-11-30T15:47:15.656985Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-1jpyzc", "title": "Write tests for --status any/open/closed flag behavior", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:53:02.072158Z", "updated_at": "2025-11-17T23:11:05.750949Z", "closed_at": "2025-11-17T23:11:05.750949Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}]}
{"id": "trace-1lwb01", "title": "Test issue with name flag", "description": "Testing name-based project resolution", "status": "closed", "priority": 2, "created_at": "2025-11-30T23:13:22.737691Z", "updated_at": "2025-11-30T23:13:31.393552Z", "closed_at": null, "dependencies": []}
{"id": "trace-1lz9ob", "title": "Review and clean up README content", "description": "Review the README and clean up lines that could be improved. Some sections may be verbose or unclear. Focus on making it more concise and reader-friendly.", "status": "closed", "priority": 2, "created_at": "2025-11-18T02:20:08.820766Z", "updated_at": "2025-11-18T02:26:24.583140Z", "closed_at": "2025-11-18T02:26:24.583140Z", "dependencies": []}
{"id": "trace-1m3w81", "title": "Show dependencies and dependents in tree view", "description": "YAGNI - Not implementing. Current tree view is sufficient for now.", "status": "closed", "priority": 3, "created_at": "2025-11-30T15:31:08.376428Z", "updated_at": "2025-12-01T01:41:30.150542Z", "closed_at": "2025-12-01T01:41:30.150542Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-1md7ua", "title": "Test issue with path flag", "description": "Testing path-based project resolution", "status": "closed", "priority": 2, "created_at": "2025-11-30T23:13:18.081858Z", "updated_at": "2025-11-30T23:13:31.340302Z", "closed_at": null, "dependencies": []}
{"id": "trace-1mmpb4", "title": "Update quickstart.md for new list behavior", "description": "Update docs/quickstart.md to reflect new default behavior in getting started examples. Ensure examples show backlog by default, mention --status closed for viewing completed work.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:42.620415Z", "updated_at": "2025-11-18T14:28:55.421103Z", "closed_at": "2025-11-18T14:28:55.421103Z", "dependencies": [{"depends_on_id": "trace-11efq1", "type": "parent"}]}
{"id": "trace-1ndtvk", "title": "Add --description flag to trc update command", "description": "Adds --description flag to trc update command. Backend already supported it in update_issue() and cli_update() functions, just needed to add CLI argument parsing in main() and update help text.", "status": "closed", "priority": 2, "created_at": "2025-11-17T20:11:30.365680Z", "updated_at": "2025-11-17T21:39:40.010851Z", "closed_at": "2025-11-17T21:39:40.010851Z", "dependencies": []}
{"id": "trace-1otw58", "title": "Fix list command --project flag filtering", "description": "Implement three-way logic in list_cmd: (1) project is None -> current dir, (2) project == 'any' -> all projects, (3) project == <name> -> look up and filter by that project", "status": "closed", "priority": 2, "created_at": "2025-11-30T19:54:14.231752Z", "updated_at": "2025-11-30T19:55:40.156547Z", "closed_at": "2025-11-30T19:55:40.156547Z", "dependencies": [{"depends_on_id": "trace-1toxy1", "type": "parent"}]}
{"id": "trace-1pgw17", "title": "Verify all existing tests pass", "description": "Run full test suite to ensure no regressions from multi-status changes", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:20:23.516157Z", "updated_at": "2025-11-18T14:23:56.102152Z", "closed_at": "2025-11-18T14:23:56.102152Z", "dependencies": [{"depends_on_id": "trace-1d5uth", "type": "parent"}]}
{"id": "trace-1tlb0r", "title": "Add 'trc update' command to guide documentation", "description": "The 'trc guide' output doesn't mention the 'trc update' command, which allows updating title, description, priority, and status of existing issues. Users may not discover this capability and resort to closing/recreating issues instead. Add to guide: 'trc update <id> --title \"...\" --description \"...\" --priority N --status X - Update existing issue'. Discovered when AI agent tried to close/recreate instead of updating issue knowledge-organization-framework-4apcmt to add Morality to scope.", "status": "closed", "priority": 2, "created_at": "2025-11-18T02:06:27.741217Z", "updated_at": "2025-11-18T02:30:27.242997Z", "closed_at": "2025-11-18T02:30:27.242997Z", "dependencies": []}
{"id": "trace-1toxy1", "title": "Fix --project flag not filtering correctly", "description": "## Root Cause Analysis\n\n**The Bug:** The `--project` flag is completely ignored except when it equals 'any'.\n\n### How It Currently Works\n\nIn `trc_main.py:1510-1569` (list_cmd), the logic is:\n\n```python\n# Handle --project flag\nif project == \"any\":\n    # List all issues across all projects\n    issues = list_issues(db, status=status_filter)\nelse:\n    # List issues for current project\n    current_project = detect_project()\n    # ...\n    issues = list_issues(db, project_id=current_project[\"id\"], status=status_filter)\n```\n\n**Problem:** The `else` branch handles BOTH cases:\n- When `project` is `None` (no flag provided) \u2192 uses current project \u2713\n- When `project` is a specific value like \"trace\" \u2192 STILL uses current project \u2717\n\nSo `trc list --project trace` from ynab-budget directory:\n1. Checks if project == \"any\" \u2192 NO\n2. Falls into else branch\n3. Calls detect_project() \u2192 finds ynab-budget (current dir)\n4. Shows ynab-budget issues (WRONG!)\n\n### Expected Behavior\n\nShould have THREE cases:\n1. `project is None` \u2192 use current project\n2. `project == \"any\"` \u2192 show all projects  \n3. `project == <specific-name>` \u2192 look up that project in registry and filter by it\n\n### The Fix\n\n```python\n# Handle --project flag\nif project == \"any\":\n    # List all issues across all projects\n    issues = list_issues(db, status=status_filter)\nelif project is not None:\n    # Look up specific project by name (or path)\n    cursor = db.execute(\n        \"SELECT id, name, current_path FROM projects WHERE name = ?\",\n        (project,)\n    )\n    row = cursor.fetchone()\n    if row is None:\n        print(f\"Error: Project '{project}' not found in registry\")\n        print(\"Hint: Run 'trc list --project any' to see all projects\")\n        db.close()\n        raise typer.Exit(code=1)\n    \n    target_project = {\"id\": row[0], \"name\": row[1], \"path\": row[2]}\n    sync_project(db, target_project[\"path\"])\n    issues = list_issues(db, project_id=target_project[\"id\"], status=status_filter)\nelse:\n    # No --project flag, use current directory\n    current_project = detect_project()\n    if current_project is None:\n        print(\"Error: Not in a git repository. Use --project any to list all issues.\")\n        db.close()\n        raise typer.Exit(code=1)\n    sync_project(db, current_project[\"path\"])\n    issues = list_issues(db, project_id=current_project[\"id\"], status=status_filter)\n```\n\n### Commands Affected\n\nSame bug exists in:\n- `list_cmd` (trc_main.py:1510)\n- `ready` (trc_main.py:1688)\n\nBoth need the same three-way logic.\n\n### Relationship to trace-1dn75j\n\nThis is orthogonal to trace-1dn75j. That issue is about accepting paths vs names. This issue is about the flag being ignored entirely. We need to:\n1. First fix THIS bug (flag being ignored)\n2. Then enhance to accept paths (trace-1dn75j)\n\n### Test Case\n\n```bash\n# From ynab-budget directory\ntrc list --project trace\n\n# Should show trace issues, currently shows ynab-budget issues\n```", "status": "closed", "priority": 0, "created_at": "2025-11-30T15:31:08.058240Z", "updated_at": "2025-11-30T19:55:40.385039Z", "closed_at": "2025-11-30T19:55:40.385039Z", "dependencies": [{"depends_on_id": "trace-1dn75j", "type": "related"}, {"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-1usx4o", "title": "Test with description", "description": "This is a test", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:19:12.693574Z", "updated_at": "2025-11-17T21:20:20.716477Z", "closed_at": "2025-11-17T21:20:20.716477Z", "dependencies": []}
{"id": "trace-1uzjlc", "title": "Implement --project any in list_issues() and cli_list()", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:54:55.479495Z", "updated_at": "2025-11-17T23:11:05.901459Z", "closed_at": "2025-11-17T23:11:05.901459Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}, {"depends_on_id": "trace-ki1b46", "type": "blocks"}]}
{"id": "trace-1v6mds", "title": "Documentation: Evaluate redundancy between trc guide command and docs/ai-agent-guide.md", "description": "## Problem\n\nWe have two similar but different documentation sources for AI agent integration:\n\n1. **`trc guide` command** (trc_main.py:1877-1970)\n   - Hardcoded text, 90 lines\n   - Designed to fit on one screen\n   - Users run `trc guide` and paste into their CLAUDE.md\n   - **This is what AI agents actually see and use**\n   - Source of truth for practical usage\n\n2. **`docs/ai-agent-guide.md`**\n   - Comprehensive reference, 358 lines\n   - Much more detailed with examples and workflows\n   - NOT actively consumed by users (guide is hardcoded)\n   - May drift out of sync with `trc guide` output\n\n## Questions to Answer\n\n1. **Should we keep both?**\n   - If yes: What's the relationship? Should they stay in sync?\n   - If no: Which one should we keep?\n\n2. **If we keep both:**\n   - Is ai-agent-guide.md valuable as extended documentation?\n   - Should we reference it from `trc guide` output?\n   - Who is the audience for the comprehensive guide?\n\n3. **If we consolidate:**\n   - Should `trc guide` read from ai-agent-guide.md (extract/summarize)?\n   - Or should we delete ai-agent-guide.md and just maintain hardcoded guide?\n\n## Current State Analysis\n\n**ai-agent-guide.md has valuable content not in `trc guide`:**\n- Detailed workflow examples (feature planning, bug discovery, iterative refinement)\n- Cross-session continuity patterns\n- Integration with TodoWrite discussion\n- Extended examples with full command sequences\n- Philosophy and best practices sections\n\n**`trc guide` is concise by design:**\n- Fits on one screen for easy pasting\n- Quick reference format\n- Just enough to get started\n- No extended examples or workflows\n\n## Possible Approaches\n\n### Option A: Keep Both with Clear Roles\n- **`trc guide`**: Quick start template for CLAUDE.md (current state)\n- **`docs/ai-agent-guide.md`**: Comprehensive reference\n- Add to `trc guide` output: \"For detailed workflows see docs/ai-agent-guide.md\"\n- Accept they may drift slightly (guide is minimal, docs are comprehensive)\n\n### Option B: Generate Guide from Docs\n- Make `trc guide` command read and summarize ai-agent-guide.md\n- Keep single source of truth (ai-agent-guide.md)\n- Guide command extracts key sections programmatically\n- More complex implementation\n\n### Option C: Delete ai-agent-guide.md\n- Only maintain hardcoded `trc guide` output\n- Add comprehensive examples to `trc guide` (but then it's no longer one screen)\n- Simpler maintenance, but lose comprehensive reference\n\n### Option D: Move Comprehensive Docs to README or Wiki\n- Keep `trc guide` minimal and hardcoded\n- Move ai-agent-guide.md content to README.md or GitHub wiki\n- Clear separation: command output vs documentation site\n\n## Impact of Decision\n\n**Keeping both:**\n- \u2705 Comprehensive reference available for those who want it\n- \u2705 Quick-start guide stays concise\n- \u26a0\ufe0f Risk of drift/inconsistency\n- \u26a0\ufe0f Maintenance burden to keep both updated\n\n**Consolidating to guide only:**\n- \u2705 Single source of truth\n- \u2705 Simpler maintenance\n- \u274c Lose comprehensive examples and workflows\n- \u274c May become too long for one-screen quick reference\n\n**Generating guide from docs:**\n- \u2705 Single source of truth\n- \u2705 Keep comprehensive docs\n- \u274c More complex implementation\n- \u26a0\ufe0f Guide generation logic needs maintenance\n\n## Recommendation Needed\n\nNeed to decide on approach before making further documentation updates (like adding investigation pattern guidance).\n\nCurrently leaning toward **Option A** (keep both with clear roles), but want explicit decision on:\n1. What's the purpose of ai-agent-guide.md if nobody uses it?\n2. Should we actively promote it or just let `trc guide` be the interface?\n3. When making changes (like investigation pattern), update both or just guide?", "status": "open", "priority": 2, "created_at": "2025-11-21T13:53:00.658208Z", "updated_at": "2025-11-21T13:53:00.658208Z", "closed_at": null, "dependencies": []}
{"id": "trace-1vaoox", "title": "Test cross-project creation", "description": "Testing --project flag from outside trace repo", "status": "closed", "priority": 2, "created_at": "2025-11-18T02:49:04.759579Z", "updated_at": "2025-11-18T02:49:12.492233Z", "closed_at": "2025-11-18T02:49:12.492233Z", "dependencies": []}
{"id": "trace-1vp9ml", "title": "Bug: Cross-project related dependencies break trc update", "description": "## Bug Report\n\nWhen a trace has a `related` dependency to a trace in another project that is not initialized locally, `trc update` fails with:\n\n```\nError: Project not initialized\nRun 'trc init' in gitlab.internal.equipmentshare.com/data-ops/change-capture-infra first\n```\n\n### Steps to Reproduce\n1. In project A, create a trace\n2. Link it to a trace in project B using `--type related`\n3. Try to update the trace in project A with `trc update`\n4. Error occurs even though you're only updating project A's trace\n\n### Expected Behavior\nShould be able to update a trace even if related cross-project traces are in non-initialized projects. The related link is informational only.\n\n### Actual Behavior\nUpdate fails because trace tries to resolve/validate the related dependency in the other project.\n\n### Example\n```bash\n# In change-capture project\ntrc add-dependency change-capture-fc5igx change-capture-infra-11ibn4 --type related\n\n# Later, trying to update a child trace\ntrc update change-capture-1jy3yy --status in_progress\n# Error: Project not initialized for change-capture-infra\n```\n\n### Workaround\nNone currently - cannot update traces that have cross-project related dependencies unless all related projects are initialized locally.", "status": "closed", "priority": 1, "created_at": "2025-12-02T17:28:34.900691Z", "updated_at": "2025-12-02T19:52:30.664385Z", "closed_at": "2025-12-02T19:52:30.664385Z", "dependencies": [{"depends_on_id": "trace-noekf7", "type": "parent"}]}
{"id": "trace-1xm9bv", "title": "Clarify TodoWrite vs trace usage in CLAUDE.md", "description": "Add explicit override guidance to CLAUDE.md: TodoWrite's general instructions suggest using it for 'complex multi-step tasks', but this project uses trace for all non-trivial work. Make it clear that TodoWrite is ONLY for trivial, single-session work. Anything involving multiple files, tests, or spanning sessions should use trace.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:20:39.188540Z", "updated_at": "2025-11-18T14:32:32.025487Z", "closed_at": "2025-11-18T14:32:32.025487Z", "dependencies": []}
{"id": "trace-1y3m2h", "title": "Documentation: Add investigation pattern guidance to trc guide command", "description": "**Problem:** The `trc guide` output doesn't distinguish between investigation outputs vs implementation work, leading to confusion about when to close investigations.\n\n## Context Clarification\n\nThere are three separate documents:\n1. **`trc guide` command** (hardcoded in trc_main.py:1877-1970) - **SOURCE OF TRUTH**\n   - 90 lines, designed to fit on one screen\n   - Users run this and paste output into their CLAUDE.md\n   - This is what AI agents actually see and use\n2. **`docs/ai-agent-guide.md`** - Comprehensive reference (358 lines)\n   - More detailed but NOT actively consumed (guide is hardcoded)\n   - Could be kept in sync or allowed to drift\n3. **This repo's CLAUDE.md** - For developing trace itself (not relevant here)\n\nWhen parent issue says \"add to CLAUDE.md\", it means: **update the `trc guide` hardcoded text** so users get this guidance when they run the command.\n\n## What's Missing from `trc guide` Output\n\nCurrent guide has:\n- When to use trace vs TodoWrite\n- Granularity philosophy  \n- Key commands\n- Cross-project usage\n\nMissing:\n- **Investigation pattern** - how to structure exploratory work\n- When findings/documentation should be children vs siblings\n- How to close investigation work without closing implementation work\n\n## Root Cause of Confusion\n\nDuring change-capture investigation (Schema Registry removal), encountered dual-parent relationships and couldn't close investigation cleanly. The guide didn't explain that:\n- Investigation findings = ephemeral documentation (children that close together)\n- Implementation work = deliverables (siblings that stay open after investigation)\n\n## Recommendation\n\n**Should we do this?** **YES** \u2713\n\n**Target:** Update hardcoded `guide_text` in trc_main.py:1879-1969\n\n**Constraint:** Keep it concise (guide should fit on one screen, ~90 lines total)\n\n## Implementation Plan\n\n### Phase 1: Add Investigation Pattern Content\n\nAdd after the \"Granularity Philosophy\" section (around line 1906), before \"Proactive Usage\":\n\n```python\n**Investigation Pattern:**\nWhen exploring code or investigating issues, structure helps separate analysis from work:\n\n- Investigation = child of epic/feature (closes when analysis done)\n- Investigation findings = children of investigation (documentation, close together)\n- Implementation work = siblings of investigation (stay open, reference findings)\n\nExample:\n```\nEpic: Improve performance\n\u251c\u2500 Investigation: Query bottlenecks [close when done]\n\u2502  \u251c\u2500 Finding: N+1 queries [documentation]\n\u2502  \u2514\u2500 Finding: Missing index [documentation]\n\u251c\u2500 Task: Add index [stays open, references findings]\n\u2514\u2500 Task: Refactor queries [stays open, references findings]\n```\n\nAnti-pattern: Making action items children of investigation (can't close investigation).\nInstead: Create tasks as siblings, reference investigation in description.\n```\n\n**Length:** ~15 lines (keeps guide under 100 lines total)\n\n### Phase 2: Quality Review & Refactor (CRITICAL)\n\n**DO NOT just add content and stop.** After adding investigation pattern:\n\n1. **Review entire `trc guide` output for quality**\n   - Read it as if you're a new user\n   - Check for redundancy, unclear language, or bloat\n   - Ensure it still fits on one screen\n\n2. **Refactor for clarity and conciseness**\n   - Can any sections be combined?\n   - Are there redundant examples?\n   - Is the language as concise as possible?\n   - Does the flow make sense?\n\n3. **Test the length**\n   - Run `trc guide | wc -l` to verify still under ~100 lines\n   - If over, cut or condense other sections\n   - Priority: keep it scannable and actionable\n\n4. **Validate with fresh eyes**\n   - Does it answer: \"When do I use trace?\" \u2713\n   - Does it answer: \"How do I structure work?\" \u2713\n   - Does it answer: \"What commands do I need?\" \u2713\n   - Is anything confusing or unnecessary?\n\n**Goal:** High-quality, concise guide that doesn't bloat over time.\n\n**Anti-pattern:** Incremental additions without refactoring = death by a thousand cuts\n\n## Success Criteria\n\n- [ ] Investigation pattern added to guide\n- [ ] Entire guide reviewed for quality\n- [ ] Redundancy removed, language tightened\n- [ ] Guide still fits on one screen (~90-100 lines max)\n- [ ] Fresh read confirms clarity and scannability\n- [ ] No bloat or unnecessary verbosity\n\n## Impact\n\n- Prevents dual-parent confusion\n- Clarifies when to close investigation work\n- Maintains guide quality through refactoring discipline\n- High value for AI agents doing exploratory work\n\n## Open Question\n\nShould we also update `docs/ai-agent-guide.md` to stay in sync, or just let it be a separate comprehensive reference that may drift?", "status": "open", "priority": 2, "created_at": "2025-11-20T21:58:55.926717Z", "updated_at": "2025-11-21T14:17:58.938108Z", "closed_at": null, "dependencies": [{"depends_on_id": "trace-1gbj2x", "type": "parent"}]}
{"id": "trace-1ympls", "title": "Update list_issues() to support multiple statuses", "description": "Modify list_issues() function to accept status: Optional[str | list[str]]. When given a list, use SQL IN clause. When given 'any' or None for all statuses, use no filter.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:20:23.178832Z", "updated_at": "2025-11-18T14:23:14.049583Z", "closed_at": "2025-11-18T14:23:14.049583Z", "dependencies": [{"depends_on_id": "trace-1d5uth", "type": "parent"}]}
{"id": "trace-4pccvs", "title": "Test without description", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:29:49.415612Z", "updated_at": "2025-11-17T21:30:00.446056Z", "closed_at": "2025-11-17T21:30:00.446056Z", "dependencies": []}
{"id": "trace-4z5w8k", "title": "Update list CLI to accept multiple --status flags", "description": "Change list command to accept multiple --status flags. Default to ['open', 'in_progress', 'blocked'] when no flags provided. Handle 'any' special case.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:20:23.290139Z", "updated_at": "2025-11-18T14:23:43.292070Z", "closed_at": "2025-11-18T14:23:43.292070Z", "dependencies": [{"depends_on_id": "trace-1d5uth", "type": "parent"}]}
{"id": "trace-5fyvij", "title": "Test batch 2", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-30T23:46:39.484224Z", "updated_at": "2025-11-30T23:46:43.400269Z", "closed_at": "2025-11-30T23:46:43.400269Z", "dependencies": []}
{"id": "trace-64rf5b", "title": "UX improvements from real-world AI agent usage", "description": "Feedback from using trace with Claude Code in ynab-budget project.\n\nCRITICAL ISSUES:\n1. Better initialization errors - 'FileNotFoundError' should suggest 'trc init'. Got cryptic error when trying to create issues before init.\n2. Batch operations - Cannot close multiple issues at once. Need: trc close ID1 ID2 ID3\n3. Clearer dependency language - 'Added blocks dependency: A \u2192 B' is confusing. Reads like 'A blocks B' but means opposite. Suggest: 'A depends on B' or 'A is blocked by B'\n4. Transaction safety - Partial writes to global DB even when JSONL fails. Should rollback or complete both.\n5. BUG: trc list --project trace shows wrong project - When run from ynab-budget directory, 'trc list --project trace' shows ynab-budget issues instead of trace issues. But 'trc list --project any | grep trace-' works correctly. Seems like --project flag not filtering properly.\n\nNICE TO HAVE:\n6. Priority flexibility - Accept both numeric (4) and text (high/critical)\n7. Dependency visualization - Show both dependencies and dependents in tree view\n8. Better list filtering - Add --all, --active, --priority flags\n9. Dependency removal - trc remove-dependency command (may exist but not documented?)\n\nWHAT WORKED WELL:\n\u2705 Mandatory descriptions (brilliant for AI context)\n\u2705 trc ready command (extremely useful)\n\u2705 JSONL format (git-friendly)\n\u2705 Readable IDs (ynab-budget-1y2ul1 > UUIDs)\n\u2705 Cross-project support\n\nCONTEXT: Using trace with Claude Code to manage ynab-budget project. Tool solves real problem (AI memory across sessions). Core concept is excellent, just needs UX polish on error messages and bulk operations.\n\nOverall Grade: B+ - Would recommend despite rough edges.", "status": "closed", "priority": 3, "created_at": "2025-11-30T15:27:34.273438Z", "updated_at": "2025-12-01T01:41:30.151288Z", "closed_at": "2025-12-01T01:41:30.151288Z", "dependencies": []}
{"id": "trace-69ouzm", "title": "Test batch 3", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-30T23:46:39.597516Z", "updated_at": "2025-11-30T23:46:43.400769Z", "closed_at": "2025-11-30T23:46:43.400769Z", "dependencies": []}
{"id": "trace-6zwjgn", "title": "Improve init error messages to suggest trc init", "description": "When FileNotFoundError occurs (e.g., trying to create issues before init), show user-friendly error suggesting 'trc init'. Current cryptic error confuses users.", "status": "closed", "priority": 1, "created_at": "2025-11-30T15:31:07.451888Z", "updated_at": "2025-11-30T23:38:25.051670Z", "closed_at": "2025-11-30T23:38:25.051670Z", "dependencies": [{"depends_on_id": "trace-16so9a", "type": "related"}, {"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-7fpjn5", "title": "Implement mandatory --description validation in cli_create()", "description": "Update cli_create() and main() argument parsing to require --description flag. Throw clear error if missing: 'Error: --description is required. Use --description \"...\" or --description \"\" for none.' Allow empty string as explicit opt-out. Update argument parsing in main() to check for this. Part of mandatory description work (trace-nbiip2).", "status": "closed", "priority": 2, "created_at": "2025-11-17T20:13:35.289628Z", "updated_at": "2025-11-17T21:19:02.058585Z", "closed_at": "2025-11-17T21:19:02.058585Z", "dependencies": [{"depends_on_id": "trace-nbiip2", "type": "parent"}]}
{"id": "trace-7tn2rj", "title": "Update README and other docs for mandatory --description", "description": "Update README.md, quickstart.md, cli-design.md to reflect mandatory --description flag. Show examples with descriptions. Update error examples. Part of making --description mandatory (trace-nbiip2).", "status": "closed", "priority": 2, "created_at": "2025-11-17T20:13:13.277052Z", "updated_at": "2025-11-17T21:27:24.793389Z", "closed_at": "2025-11-17T21:27:24.793389Z", "dependencies": [{"depends_on_id": "trace-nbiip2", "type": "parent"}]}
{"id": "trace-adiu0x", "title": "Write tests for multi-status list behavior", "description": "Add tests for: multiple status flags, default backlog behavior, --status any, single status flag still works, empty results handling", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:20:23.402913Z", "updated_at": "2025-11-18T14:22:51.064269Z", "closed_at": "2025-11-18T14:22:51.064269Z", "dependencies": [{"depends_on_id": "trace-1d5uth", "type": "parent"}]}
{"id": "trace-b7ijb2", "title": "Test with empty description", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:19:18.197804Z", "updated_at": "2025-11-17T21:20:20.749659Z", "closed_at": "2025-11-17T21:20:20.749659Z", "dependencies": []}
{"id": "trace-brxyyz", "title": "Test with empty description", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:33:50.971500Z", "updated_at": "2025-11-17T21:34:00.182705Z", "closed_at": "2025-11-17T21:34:00.182705Z", "dependencies": []}
{"id": "trace-cozpy3", "title": "Add better list filtering options", "description": "YAGNI - Not implementing. Current filtering with --status flags is sufficient for now.", "status": "closed", "priority": 3, "created_at": "2025-11-30T15:31:08.534277Z", "updated_at": "2025-12-01T01:41:30.150941Z", "closed_at": "2025-12-01T01:41:30.150941Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-f28qjw", "title": "Document uv tool install workflow in README", "description": "Add section explaining how to install trc globally using 'uv tool install .' for regular use, and 'uv tool install --editable .' for development. The editable install allows making changes to the code while having the trc command available globally.", "status": "closed", "priority": 2, "created_at": "2025-11-18T02:20:08.717939Z", "updated_at": "2025-11-18T02:22:43.240305Z", "closed_at": "2025-11-18T02:22:43.240305Z", "dependencies": []}
{"id": "trace-f8qgew", "title": "Feedback from AI agent usage: Clarify investigation granularity and status update patterns", "description": "## Feedback from Claude AI Agent Usage of Trace\n\n### Context:\nUsed trace extensively during Flink CDC investigation (created ~14 issues, complete investigation trail from hypothesis through root cause to recommendation). Overall experience was very positive, tool worked as expected.\n\n### What Worked Well:\n1. Persistent context across investigation - updating descriptions as we learned was valuable\n2. Parent-child relationships - organized investigation logically\n3. Cross-project linking - seamless to create recommendation in different project\n4. Required descriptions - forced clarity at each step\n5. Tool behavior - all commands worked as documented, no surprises\n\n### Suggested Instruction Improvements:\n\n#### 1. Guidance on Issue Granularity During Exploration\n\nCurrent: 'Structure is fluid, not rigid' and 'if breakdown is too fine-grained, reparent issues'\n\nUnclear during active investigation:\n- Should I create an issue for EVERY hypothesis I want to test?\n- Or only for things I'm confident need tracking?\n\nDuring this investigation: Created ~10+ issues, many became obsolete within minutes as we pivoted. Worked fine but wasn't sure if this was the intended pattern.\n\nSuggested addition:\n> During exploratory investigation, it's fine to create many hypothesis issues and close them as you rule them out. This creates an audit trail of what was considered and why it was ruled out. Alternatively, you can use a single investigation issue and update its description as you learn more. Choose based on whether the audit trail of hypotheses is valuable.\n\n#### 2. When to Use --status in_progress vs Just Working\n\nCurrent: Instructions mention updating status 'in real-time' but unclear:\n- Do I mark in_progress before every task, even quick ones?\n- Or only for longer-running work?\n\nDuring investigation: Sometimes forgot to mark in_progress before starting, had to go back and update.\n\nSuggested addition:\n> For quick investigations (under 5 minutes), updating to in_progress is optional - you can go straight from open to closed. For anything longer-running, mark in_progress when you start to signal you're actively working on it. This helps if multiple agents/people are coordinating work.\n\n#### 3. Cross-Project Recommendations Pattern\n\nThis pattern worked perfectly but wasn't explicitly documented:\n- Investigate in one project/codebase\n- Create recommendation issue in different project for another team\n\nWhat happened: Investigated Flink CDC codebase (flink-cdc project), created actionable recommendation in change-capture project for EquipmentShare team to implement.\n\nSuggested addition to examples:\n> When investigating issues in one codebase that result in recommendations for another team's codebase, create the investigation issues in the code being analyzed, then create a separate recommendation issue in the team's project using --project flag. This keeps investigation details separate from actionable items.\n\n### Example Usage Pattern From This Investigation:\n\nInvestigation flow:\n1. Main issue: flink-cdc-1r1b37 (root investigation)\n2. Created child hypotheses as we explored (kwfnuj, 1ffulj, 1y9spy, etc.)\n3. Updated descriptions as findings emerged\n4. Closed hypotheses as we ruled them out or confirmed them\n5. Final: Created change-capture-t6hbdj with actionable recommendation in different project\n\nThis created excellent audit trail showing:\n- What was investigated (configuration propagation, queue behavior, threading model)\n- What was ruled out (consumer-side batching, configuration errors)\n- What was confirmed (producer thread commit overhead)\n- Actionable next step (code change recommendation)\n\n### Overall Assessment:\n\nInstructions are quite good. Suggested improvements are minor refinements to help AI agents make better judgment calls during exploratory work. Tool behavior was excellent - no bugs, worked exactly as documented.\n\n### Use Case:\nMulti-codebase investigation (Flink CDC + Debezium source code) resulting in recommendation for different team (change-capture). Trace handled this very well.", "status": "closed", "priority": 2, "created_at": "2025-11-20T21:07:01.394491Z", "updated_at": "2025-11-21T00:56:56.488493Z", "closed_at": null, "dependencies": []}
{"id": "trace-fu24tp", "title": "Migrate CLI from manual argument parsing to Typer", "description": "Current implementation uses manual sys.argv parsing (~200 lines of boilerplate). This makes adding new flags error-prone and verbose. Typer would provide: automatic help generation, type validation, cleaner code, better error messages, and natural support for optional/required arguments. This refactoring would eliminate manual parsing in main() and all the while-loop flag parsing. Critical for mandatory --description (trace-nbiip2) and --project/--status flags (trace-1ak6bv). Should also make it easier to add commands like add-dependency. Migration involves: 1) Add typer dependency, 2) Convert each command to @app.command(), 3) Replace manual parsing with function signatures, 4) Ensure all tests still pass.", "status": "closed", "priority": 0, "created_at": "2025-11-17T21:12:25.121949Z", "updated_at": "2025-11-17T21:52:03.334999Z", "closed_at": "2025-11-17T21:52:03.334999Z", "dependencies": []}
{"id": "trace-hbhd8g", "title": "Fix confusing dependency language in output", "description": "Current: 'Added blocks dependency: A \u2192 B' reads like 'A blocks B' but means opposite (A is blocked by B). Change to clearer language like 'A depends on B' or 'A is blocked by B' to match mental model.", "status": "closed", "priority": 1, "created_at": "2025-11-30T15:31:07.750863Z", "updated_at": "2025-11-30T23:41:37.645827Z", "closed_at": "2025-11-30T23:41:37.645827Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-j71u4g", "title": "Write tests for portable project IDs", "description": "Add tests for: git remote URL detection, local-only path fallback, auto-merge when identifier changes, JSONL format without project_id, migration from old format, cross-machine portability scenarios.", "status": "closed", "priority": 0, "created_at": "2025-11-30T16:16:45.600921Z", "updated_at": "2025-11-30T16:32:23.679400Z", "closed_at": "2025-11-30T16:32:23.679400Z", "dependencies": [{"depends_on_id": "trace-t2yxk3", "type": "parent"}]}
{"id": "trace-jc8qak", "title": "Add trc add-dependency command to link existing issues", "description": "Discovered during flag refactoring work (trace-1ak6bv): Created breakdown of tasks, then realized some should block others (e.g., docs blocked by implementation). Currently can only set dependencies during creation with --depends-on flag. No way to add blocking relationships to existing issues. Need: 'trc add-dependency <issue-id> <depends-on-id> [--type blocks|parent|related]'. Default type should be 'blocks'. This enables proper workflow ordering without recreating issues. Immediate use case: block trace-1hs8ox, trace-ryfafc, trace-rdfx3o by implementation tasks.", "status": "closed", "priority": 1, "created_at": "2025-11-17T20:10:59.980053Z", "updated_at": "2025-11-17T20:26:55.968227Z", "closed_at": "2025-11-17T20:26:55.968227Z", "dependencies": []}
{"id": "trace-jmwp5k", "title": "Test with description", "description": "This should work", "status": "closed", "priority": 2, "created_at": "2025-11-17T21:33:45.854500Z", "updated_at": "2025-11-17T21:34:00.160884Z", "closed_at": "2025-11-17T21:34:00.160884Z", "dependencies": []}
{"id": "trace-ki1b46", "title": "Write tests for --project any flag behavior", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:53:01.675847Z", "updated_at": "2025-11-17T23:11:05.700318Z", "closed_at": "2025-11-17T23:11:05.700318Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}]}
{"id": "trace-l6n0fm", "title": "Write tests for mandatory --description validation", "description": "Write tests that verify --description is required for trc create. Test should fail with clear error when --description is missing. Test should succeed with --description provided. Test should succeed with --description \"\" (empty string opt-out). Add to tests/test_cli.py. Part of mandatory description work (trace-nbiip2).", "status": "closed", "priority": 2, "created_at": "2025-11-17T20:13:34.923536Z", "updated_at": "2025-11-17T20:37:20.289177Z", "closed_at": "2025-11-17T20:37:20.289177Z", "dependencies": [{"depends_on_id": "trace-nbiip2", "type": "parent"}]}
{"id": "trace-nbiip2", "title": "Make --description mandatory for trc create command", "description": "Observation: AI agents (including this session) inconsistently add descriptions when creating issues. Reviewed change-capture project: 2/5 issues had descriptions, 3/5 did not. Context loss is the biggest risk for cross-session AI workflows. Decision: Make --description mandatory for trc create to force context capture. Allow empty string (--description \"\") as explicit opt-out for edge cases. Primary users are AI agents working across sessions - they can easily provide context, and it's critical for continuity. Add clear error message if missing, guiding users to provide description or use empty string.", "status": "closed", "priority": 1, "created_at": "2025-11-17T20:11:10.775665Z", "updated_at": "2025-11-17T21:27:36.634812Z", "closed_at": "2025-11-17T21:27:36.634812Z", "dependencies": []}
{"id": "trace-noekf7", "title": "Bug: Projects table data corruption causes cross-project operations to fail", "description": "## Summary\n\n**FIXED** in commit: Changed `show` command at line 1665 to use `get_project_path()` instead of passing `issue['project_id']` directly to `sync_project()`.\n\nTwo bugs share a common root cause: data corruption in the `projects` table where the `current_path` column contains a URL instead of a filesystem path.\n\n## Root Cause (FIXED)\n\n**The bug was at `trc_main.py:1665` in the `show` command:**\n```python\nsync_project(db, issue['project_id'])  # Passed URL, not path!\n```\n\n**Fix:**\n```python\nproject_path = get_project_path(db, issue['project_id'])\nif project_path:\n    sync_project(db, project_path)\n```\n\n## Test Added\n\n`test_cli_show_cross_project_does_not_corrupt_projects_table` in test_cli.py verifies the fix.\n\n## Child Issues\n\nMay still need verification:\n- trace-y47npx: Project not initialized error for cross-project traces\n- trace-1vp9ml: Cross-project related dependencies break trc update", "status": "closed", "priority": 1, "created_at": "2025-12-02T18:37:56.919540Z", "updated_at": "2025-12-02T19:52:34.788931Z", "closed_at": "2025-12-02T19:52:34.788931Z", "dependencies": []}
{"id": "trace-pzgtro", "title": "Update projects table schema for portable IDs", "description": "Change projects table: id (remote URL or path) as PRIMARY KEY, name (extracted name), current_path (absolute path). Migrate existing data from old schema.", "status": "closed", "priority": 0, "created_at": "2025-11-30T16:16:45.131242Z", "updated_at": "2025-11-30T16:28:58.295328Z", "closed_at": "2025-11-30T16:28:58.295328Z", "dependencies": [{"depends_on_id": "trace-t2yxk3", "type": "parent"}]}
{"id": "trace-qt70sl", "title": "Remove project_id field from JSONL format", "description": "Update export_to_jsonl() and import_from_jsonl() to exclude project_id field. JSONL should only contain issue data - project identity comes from git context. Add migration logic to strip project_id from existing JSONL files.", "status": "closed", "priority": 0, "created_at": "2025-11-30T16:16:45.246994Z", "updated_at": "2025-11-30T16:32:15.888290Z", "closed_at": "2025-11-30T16:32:15.888290Z", "dependencies": [{"depends_on_id": "trace-t2yxk3", "type": "parent"}]}
{"id": "trace-rdfx3o", "title": "Update trc guide command output with new flags", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:53:03.669896Z", "updated_at": "2025-11-17T23:11:05.851040Z", "closed_at": "2025-11-17T23:11:05.851040Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}, {"depends_on_id": "trace-ryfafc", "type": "related"}]}
{"id": "trace-ryfafc", "title": "Update all documentation with new flag usage", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:53:03.270493Z", "updated_at": "2025-11-17T23:11:05.800779Z", "closed_at": "2025-11-17T23:11:05.800779Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}, {"depends_on_id": "trace-7fpjn5", "type": "blocks"}]}
{"id": "trace-scxxay", "title": "Bug: trc close/update fail while trc ready/show work for same issue", "description": "## Problem\n`trc ready` and `trc show` work correctly for cross-project issues, but `trc close` and `trc update` fail with project initialization errors.\n\n## Root Cause\nTwo functions were not validating that `current_path` from the projects table is actually a filesystem path (vs a corrupted URL):\n1. `get_project_path()` - used by update/close commands\n2. `resolve_project()` - used by --project flag\n\n## Fixes Applied\n1. `get_project_path()` now validates `current_path` is absolute, auto-repairs when user is in correct directory\n2. `resolve_project()` now validates `current_path` is absolute, returns None if corrupted (with helpful error)\n\n## Tests Added\n- `test_cli_update_recovers_from_corrupted_project_path`\n- `test_cli_close_recovers_from_corrupted_project_path`\n- `test_cli_create_with_project_flag_detects_corrupted_path`\n\n## User Recovery\nFor corrupted projects, run `trc init` in the target project directory to re-register with correct path.", "status": "closed", "priority": 2, "created_at": "2025-12-02T19:56:40.809976Z", "updated_at": "2025-12-02T20:14:24.078396Z", "closed_at": "2025-12-02T20:14:24.078396Z", "dependencies": [{"depends_on_id": "trace-sll8bh", "type": "related"}]}
{"id": "trace-sll8bh", "title": "Bug: SSH vs HTTPS git remote URL mismatch breaks project detection", "description": "## Problem\n`trc ready` and `trc list` return no issues in a repo where issues exist, because the current project isn't detected correctly.\n\n## Root Cause\nProject detection doesn't normalize SSH vs HTTPS git remote URLs.\n\n**Git remote (SSH format):**\n```\ngit@gitlab.internal.equipmentshare.com:data-ops/change-capture-infra.git\n```\n\n**Stored project name (HTTPS-style):**\n```\ngitlab.internal.equipmentshare.com/data-ops/change-capture-infra\n```\n\nThese refer to the same repo but don't match as strings.\n\n## Impact\n- `trc ready` shows 'No open issues found' even when issues exist\n- `trc list` shows 'No issues found'\n- Users must use `--project any` as workaround\n- Easy to miss work items in the current repo\n\n## Expected Behavior\nBoth URL formats should canonicalize to the same project identifier:\n- `git@host:org/repo.git` \u2192 `host/org/repo`\n- `https://host/org/repo.git` \u2192 `host/org/repo`\n\n## Workaround\nUse `--project any` flag to see all issues across projects.", "status": "closed", "priority": 2, "created_at": "2025-12-02T19:04:38.010635Z", "updated_at": "2025-12-02T20:00:44.666970Z", "closed_at": "2025-12-02T20:00:44.666970Z", "dependencies": []}
{"id": "trace-t2yxk3", "title": "Fix project_id to be machine-independent", "description": "PROBLEM: project_id uses absolute paths, making .trace/issues.jsonl not portable across machines.\n\nSOLUTION: Use git remote URL as unique identifier, remove project_id from JSONL entirely.\n\nKey Design Decisions:\n\n1. Remote URL = unique identifier for repos with remotes\n   - Example: github.com/dschartman/trace\n   - Portable across machines\n   - Extract project name from URL\n\n2. Absolute path = identifier for local-only repos\n   - No remote = not meant for collaboration anyway\n   - Portability doesn't matter for local-only\n   - If remote added later, auto-merge to URL-based identifier\n\n3. Remove project_id from JSONL files\n   - JSONL is just \"issues for this repo\"\n   - Project identity comes from git context, not JSONL content\n   - Makes JSONL truly portable\n\n4. Auto-merge when identifier changes\n   - Local path \u2192 remote URL (user adds remote)\n   - Remote URL changes (user updates remote)\n   - Detect during sync: same directory, different identifier \u2192 merge old into new\n\n5. YAGNI: Don't handle legitimate name collisions yet\n   - Two different projects could have same name (e.g., user1/trace vs user2/trace)\n   - If ambiguous: pick first match or error\n   - Over-engineering this now = YAGNI\n\nHow It Works:\n\ntrc init:\n- Detect remote URL (git remote get-url origin) or use absolute path\n- Extract project name from URL or directory name\n- Store in DB: projects(id=url_or_path, name=extracted_name, current_path=pwd)\n\nSyncing JSONL:\n- Detect current project_id (remote URL or path)\n- Check if identifier changed for this path\n- If changed: auto-merge old project into new project\n- Import/export JSONL (no project_id field!)\n\n--project flag:\n- Lookup by name in projects table\n- If multiple matches: pick first (YAGNI - don't over-engineer)\n- Future: could disambiguate with full URL\n\nJSONL Format Changes:\n\nBefore:\n{\"id\": \"trace-abc123\", \"project_id\": \"/Users/don/Repos/trace\", \"title\": \"...\"}\n\nAfter:\n{\"id\": \"trace-abc123\", \"title\": \"...\"}\n\nNo project_id field! Project identity from git context.\n\nMigration Steps:\n\n1. Detect old JSONL format (has project_id field)\n2. Strip project_id from all JSONL files\n3. Update projects table schema\n4. Migrate existing path-based IDs\n5. Test auto-merge logic\n\nEdge Cases Handled:\n\n- Repo cloned to multiple locations: \u2705 Same ID (remote URL), different current_path\n- Local repo adds remote later: \u2705 Auto-merge from path to URL\n- Remote URL changes: \u2705 Auto-merge from old to new URL\n- Name collisions: \u26a0\ufe0f YAGNI - pick first match for now\n\nRequirements:\n\n- Trace requires git (git init must be run)\n- Error message: \"Error: trace requires git. Run: git init\"", "status": "closed", "priority": 0, "created_at": "2025-11-30T15:49:35.837249Z", "updated_at": "2025-11-30T19:37:06.007815Z", "closed_at": "2025-11-30T19:37:06.007815Z", "dependencies": [{"depends_on_id": "trace-64rf5b", "type": "parent"}]}
{"id": "trace-udu2id", "title": "CLI: Add validate command to check for structural issues", "description": "**Problem:** No way to proactively detect structural problems in issue relationships.\n\n**Proposed command:**\n```bash\ntrc validate [--fix]\n```\n\n**Checks to implement:**\n\n1. **Dual-parent relationships**\n   - Flag issues with multiple parents\n   - Suggest which parent to keep\n\n2. **Orphaned issues**\n   - Find old issues with no parent, children, or dependencies\n   - Suggest closing or linking them\n\n3. **Circular dependencies**\n   - Detect A blocks B, B blocks A scenarios\n   - Report the cycle path\n\n4. **Stale investigations**\n   - Find investigations marked completed but with open children\n   - Suggest closing children or updating status\n\n5. **Broken references**\n   - Check for dependencies pointing to non-existent issues\n   - Report as data corruption\n\n**Example output:**\n```\n\u2713 No circular dependencies found\n\u26a0 2 issues with dual parents:\n  - trace-xxx has parents: trace-aaa, trace-bbb\n\u26a0 5 orphaned issues (no dependencies, >30 days old)\n  - trace-yyy: Last updated 45 days ago\n```\n\n**Optional --fix flag:** Interactively resolve issues with user prompts.", "status": "closed", "priority": 2, "created_at": "2025-11-20T21:59:38.315351Z", "updated_at": "2025-11-21T00:56:56.268817Z", "closed_at": null, "dependencies": [{"depends_on_id": "trace-1gbj2x", "type": "parent"}]}
{"id": "trace-y47npx", "title": "Bug: 'Project not initialized' error when updating/closing traces created via --project flag", "description": "## Bug Description\n\nWhen a trace is created in project A while working in project B (using cross-project creation), subsequent `trc update` and `trc close` commands fail with 'Project not initialized' error.\n\n## Steps to Reproduce\n\n1. In repo change-capture-infra, run:\n   ```\n   trc create \"Test issue\" --description \"test\" --project change-capture\n   ```\n   This succeeds and creates trace in change-capture project.\n\n2. Try to update or close it:\n   ```\n   trc update change-capture-infra-11ibn4 --status closed\n   ```\n\n3. Error:\n   ```\n   Error: Project not initialized\n   Run 'trc init' in gitlab.internal.equipmentshare.com/data-ops/change-capture first\n   ```\n\n## Observed Behavior\n\n- `trc list` works and shows issues from multiple projects\n- `trc show <id>` works for cross-project issues\n- `trc create` with `--project` flag works\n- `trc update` and `trc close` fail with 'Project not initialized'\n\n## Expected Behavior\n\nIf `trc list` and `trc show` can read cross-project traces, `trc update` and `trc close` should also work on them without requiring `trc init` in the target project directory.\n\n## Environment\n\n- Working directory: /Users/don.schartman/Repos/change-capture-infra\n- Target project: gitlab.internal.equipmentshare.com/data-ops/change-capture\n- Trace ID format: change-capture-infra-XXXXX (created in infra repo but stored in change-capture)", "status": "closed", "priority": 2, "created_at": "2025-12-02T17:02:42.753837Z", "updated_at": "2025-12-02T19:52:30.663199Z", "closed_at": "2025-12-02T19:52:30.663199Z", "dependencies": [{"depends_on_id": "trace-noekf7", "type": "parent"}]}
{"id": "trace-ycqwxo", "title": "Valid issue", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-30T23:46:48.754172Z", "updated_at": "2025-11-30T23:46:52.637368Z", "closed_at": "2025-11-30T23:46:52.637368Z", "dependencies": []}
{"id": "trace-yk4i7i", "title": "Update README.md for new list behavior", "description": "Check README.md for any references to trc list behavior and update if needed. Ensure examples show the new backlog default.", "status": "closed", "priority": 2, "created_at": "2025-11-18T14:25:42.985648Z", "updated_at": "2025-11-18T14:29:59.863034Z", "closed_at": "2025-11-18T14:29:59.863034Z", "dependencies": [{"depends_on_id": "trace-11efq1", "type": "parent"}]}
{"id": "trace-yu78qb", "title": "Add --status any/open/closed support to list and ready commands", "description": "", "status": "closed", "priority": 2, "created_at": "2025-11-17T19:53:02.874218Z", "updated_at": "2025-11-17T19:55:39.623445Z", "closed_at": "2025-11-17T19:55:39.623445Z", "dependencies": [{"depends_on_id": "trace-1ak6bv", "type": "parent"}]}
{"id": "trace-zrxavy", "title": "Add command to add dependencies to existing issues", "description": "", "status": "closed", "priority": 1, "created_at": "2025-11-17T20:02:04.359767Z", "updated_at": "2025-11-17T20:10:47.998646Z", "closed_at": "2025-11-17T20:10:47.998646Z", "dependencies": []}
